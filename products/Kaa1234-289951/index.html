<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â•ΩÂ•ΩÂ•Ω | ji3ji3</title>
    <meta name="description" content="Â•ΩÂ•ΩÂ•Ω - ji3ji3 Âö¥ÈÅ∏ÂïÜÂìÅ">

    <!-- Styles -->
    <link rel="stylesheet" href="../../src/store/styles/styles.css">

    <style>
        /* KOL Store Override */
        :root {
            --primary-color: #D68C94;
            --primary-hover: #c67a82;
            --bg-pink: #FDF2F2;
        }

        /* Product Page Specific Styles */
        .product-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .product-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 20px;
        }

        /* Gallery */
        .product-gallery {
            position: relative;
        }

        .product-gallery img {
            width: 100%;
            border-radius: 12px;
        }

        .gallery-main {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            background: #f5f5f5;
            aspect-ratio: 1;
        }

        .gallery-main img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Product Info */
        .product-info h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #333;
            line-height: 1.3;
        }

        .product-price-display {
            font-size: 1.5rem;
            color: var(--primary-color);
            font-weight: 600;
            margin: 15px 0;
        }

        .product-description {
            color: #666;
            line-height: 1.8;
            margin: 20px 0;
            white-space: pre-line;
        }

        /* Quantity */
        .qty-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .qty-controls {
            display: flex;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }

        .qty-controls button {
            width: 44px;
            height: 44px;
            border: none;
            background: #f5f5f5;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .qty-controls button:hover {
            background: #eee;
        }

        .qty-controls input {
            width: 60px;
            height: 44px;
            border: none;
            text-align: center;
            font-size: 1rem;
        }

        /* Add to Cart */
        .add-to-cart-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .add-to-cart-btn:hover {
            opacity: 0.9;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: #333;
            text-decoration: none;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .back-btn:hover {
            color: var(--primary-color);
        }

        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .product-info h1 {
                font-size: 1.4rem;
            }
        }
    </style>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Initialize Store ID -->
    <script>
        window.currentStoreId = 'aa1234';
    </script>

    <!-- Â∞éËà™Âàó -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="../../stores/aa1234/">
                    <img src="https://raw.githubusercontent.com/vvstudiocode/korea/main/logo.png" alt="Logo"
                        class="logo-img">
                    <span class="logo-text">ji3ji3</span>
                </a>
            </div>
            <div class="nav-actions">
                <button class="cart-btn" id="cartBtn" onclick="Cart.toggle()">
                    üõí Ë≥ºÁâ©Ëªä
                    <span class="cart-badge" id="cartBadge">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄ -->
    <main class="product-page">
        <a href="../../stores/aa1234/" class="back-btn">‚Üê ËøîÂõûÂïÜÂ∫ó</a>

        <div class="product-grid">
            <!-- Gallery -->
            <div class="product-gallery">
                <div class="gallery-main">
                    <img id="mainImage" src="" alt="ÂïÜÂìÅÂúñÁâá">
                </div>
            </div>

            <!-- Info -->
            <div class="product-info">
                <h1 id="productName"></h1>
                <div class="product-price-display" id="productPrice"></div>

                <div class="qty-row">
                    <span>Êï∏ÈáèÔºö</span>
                    <div class="qty-controls">
                        <button onclick="updateQty(-1)">-</button>
                        <input type="number" id="qtyInput" value="1" min="1" readonly>
                        <button onclick="updateQty(1)">+</button>
                    </div>
                </div>

                <button class="add-to-cart-btn" onclick="addToCart()">
                    Âä†ÂÖ•Ë≥ºÁâ©Ëªä
                </button>

                <div class="product-description" id="productDesc"></div>
            </div>
        </div>
    </main>

    <!-- È†ÅÂ∞æ -->
    <footer class="site-footer">
        <div class="footer-copyright">
            2025 OMO Select. All rights reserved.
        </div>
    </footer>

    <!-- Ë≥ºÁâ©ËªäÂÅ¥ÈÇäÊ¨Ñ -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Ë≥ºÁâ©Ëªä</h3>
            <button class="close-cart" id="closeCart" onclick="Cart.toggle()">‚úï</button>
        </div>
        <div class="cart-items" id="cartItems"></div>
        <div class="cart-footer">
            <div class="shipping-method-selector">
                <label>ÈÅãÈÄÅÊñπÂºèÔºö</label>
                <div class="shipping-options">
                    <label class="shipping-option">
                        <input type="radio" name="shippingMethod" value="pickup"
                            onchange="Checkout.setShippingMethod('pickup')">
                        <span>ÈôêÂè∞‰∏≠Â∏ÇÈù¢‰∫§ <strong>ÂÖçÈÅã</strong></span>
                    </label>
                    <label class="shipping-option">
                        <input type="radio" name="shippingMethod" value="711" checked
                            onchange="Checkout.setShippingMethod('711')">
                        <span>7-11 Â∫óÂà∞Â∫ó <strong>NT$ 60</strong></span>
                    </label>
                </div>
            </div>
            <div class="cart-total">
                <span>Á∏ΩË®àÔºö</span>
                <span class="total-amount" id="totalAmount">NT$ 0</span>
            </div>
            <button class="checkout-btn" id="checkoutBtn" onclick="Checkout.show()">ÂâçÂæÄÁµêÂ∏≥</button>
        </div>
    </div>

    <!-- ÈÅÆÁΩ©Â±§ -->
    <div class="overlay" id="overlay" onclick="Cart.toggle()"></div>

    <!-- ÁµêÂ∏≥ËàáÊàêÂäüÊ®°ÊÖãÊ°Ü -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content checkout-form">
            <button class="modal-close" onclick="Modal.close('checkoutModal')">‚úï</button>
            <h2>Â°´ÂØ´Êî∂‰ª∂Ë≥áË®ä</h2>
            <form id="orderForm">
                <!-- Reusing logic from checkout.js, needs form with specific IDs -->
                <div class="form-group"><label>ÂßìÂêç *</label><input type="text" id="customerName" name="name" required>
                </div>
                <div class="form-group"><label>ÊâãÊ©ü *</label><input type="tel" id="customerPhone" name="phone" required>
                </div>
                <div class="form-group"><label>Line ID *</label><input type="text" id="customerLineId" name="lineId"
                        required></div>
                <div class="form-group"><label>Email *</label><input type="email" id="customerEmail" name="email"
                        required></div>

                <div id="storeFieldsSection">
                    <div class="shipping-notice">
                        <p>üì¶ 7-11 Â∫óÂà∞Â∫óÂèñË≤®</p>
                    </div>
                    <div class="form-group"><label>ÈñÄÂ∏ÇÂêçÁ®± *</label><input type="text" id="storeName" name="storeName"
                            required></div>
                    <div class="form-group"><label>ÈñÄÂ∏ÇÂ∫óËôü *</label><input type="text" id="storeCode" name="storeCode"
                            required></div>
                    <div class="form-group"><label>ÈñÄÂ∏ÇÂú∞ÂùÄ *</label><input type="text" id="storeAddress"
                            name="storeAddress" required></div>
                </div>

                <div class="form-group"><label>ÂÇôÊ≥®</label><textarea id="customerNote" name="note" rows="3"></textarea>
                </div>

                <div class="order-summary">
                    <h3>Ë®ÇÂñÆÊëòË¶Å</h3>
                    <div id="orderSummary"></div>
                    <div class="order-total">Á∏ΩÈáëÈ°çÔºö<span id="orderTotal">NT$ 0</span></div>
                </div>
                <button type="submit" class="submit-order-btn">Á¢∫Ë™çÈÄÅÂá∫Ë®ÇÂñÆ</button>
            </form>
        </div>
    </div>

    <div class="modal" id="successModal">
        <div class="modal-content success-message">
            <div class="success-icon">‚úì</div>
            <h2>Ë®ÇÂñÆÈÄÅÂá∫ÊàêÂäüÔºÅ</h2>
            <p>Á∑®ËôüÔºö<strong id="orderNumber"></strong></p>
            <button class="continue-btn" onclick="Modal.close('successModal')">ÁπºÁ∫åË≥ºÁâ©</button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../src/core/api.js"></script>
    <script src="../../src/core/storage.js"></script>
    <script src="../../src/core/toast.js"></script>
    <script src="../../src/core/utils.js"></script>
    <script src="../../src/store/modules/products.js"></script>
    <script src="../../src/store/modules/cart.js"></script>
    <script src="../../src/store/modules/modal.js"></script>
    <script src="../../src/store/modules/checkout.js"></script>
    <script src="../../src/store/modules/kol-store.js"></script>

    <script>
        // Product Data
        const PRODUCT = {
            "id": "Kaa1234-289951",
            "name": "Â•ΩÂ•ΩÂ•Ω",
            "price": 1111,
            "image": "https://raw.githubusercontent.com/vvstudiocode/korea/main/images/products/kolaa1234/1769020285150_A4LTS__85057.webp",
            "description": "Â•ΩÂ•ΩÊäÑ"
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Init store context
            await KolStore.init();
            // Init Cart
            Cart.init();

            // Render Product
            renderProduct();

            // Setup Checkout Form Listener
            document.getElementById('orderForm').addEventListener('submit', (e) => Checkout.handleSubmit(e));
        });

        function renderProduct() {
            document.title = PRODUCT.name + ' | ji3ji3';
            document.getElementById('mainImage').src = PRODUCT.image;
            document.getElementById('productName').textContent = PRODUCT.name;
            document.getElementById('productPrice').textContent = 'NT$ ' + PRODUCT.price.toLocaleString();
            document.getElementById('productDesc').textContent = PRODUCT.description;
        }

        function updateQty(delta) {
            const input = document.getElementById('qtyInput');
            const newVal = Math.max(1, parseInt(input.value) + delta);
            input.value = newVal;
        }

        function addToCart() {
            const qty = parseInt(document.getElementById('qtyInput').value);
            Cart.add(PRODUCT, qty);
        }
    </script>
</body>

</html>