<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags - ç”±å¾Œå°ç”Ÿæˆæ™‚æ›¿æ› -->
    <title>{{STORE_NAME}} | éŸ“åœ‹ä»£è³¼</title>
    <meta name="description" content="{{STORE_DESCRIPTION}}">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{STORE_URL}}">
    <meta property="og:title" content="{{STORE_NAME}} | éŸ“åœ‹ä»£è³¼">
    <meta property="og:description" content="{{STORE_DESCRIPTION}}">
    <meta property="og:image" content="{{STORE_LOGO}}">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="{{STORE_NAME}}">
    <meta property="twitter:description" content="{{STORE_DESCRIPTION}}">
    <meta property="twitter:image" content="{{STORE_LOGO}}">

    <!-- å“ç‰Œä¸»é¡Œè‰² -->
    <style>
        :root {
            --primary-color: {
                    {
                    THEME_COLOR
                }
            }

            ;

            --accent-color: {
                    {
                    THEME_COLOR
                }
            }

            ;
        }
    </style>

    <!-- æ¨£å¼è¡¨ -->
    <link rel="stylesheet" href="/src/store/styles/styles.css">
    <link rel="stylesheet" href="/src/page-renderer/page-renderer.css">

    <style>
        /* Critical Loading Styles */
        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fcfbfb;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease;
        }

        #loadingOverlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-text {
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            letter-spacing: 2px;
            font-weight: 600;
        }
    </style>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:wght@400;600;700&display=swap"
        rel="stylesheet">
</head>

<body data-store-id="{{STORE_ID}}">
    <!-- Loading Overlay -->
    <div id="loadingOverlay">
        <video autoplay loop muted playsinline style="width: 150px; height: 150px; object-fit: contain;">
            <source src="{{LOADING_VIDEO}}" type="video/mp4">
        </video>
        <div class="loading-text">{{STORE_NAME}}</div>
    </div>

    <!-- å°èˆªåˆ— -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="{{STORE_LOGO}}" alt="{{STORE_NAME}}" class="logo-img">
                <span class="logo-text">{{STORE_NAME}}</span>
            </div>
            <div class="nav-actions">
                <button class="search-btn" id="searchBtn" onclick="openSearchModal()">
                    ğŸ” è¨‚å–®æŸ¥è©¢
                </button>
                <button class="cart-btn" id="cartBtn">
                    ğŸ›’ è³¼ç‰©è»Š
                    <span class="cart-badge" id="cartBadge">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å…§å®¹å€ -->
    <main class="main-container">
        <div id="pageBuilderRoot"></div>
    </main>

    <!-- é å°¾ -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                {{FOOTER_CONTENT}}
            </div>
        </div>
        <div class="footer-copyright">
            <div class="social-icons">
                {{SOCIAL_LINKS}}
            </div>
            {{COPYRIGHT}}
        </div>
    </footer>

    <!-- è³¼ç‰©è»Šå´é‚Šæ¬„ -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>è³¼ç‰©è»Š</h3>
            <button class="close-cart" id="closeCart">âœ•</button>
        </div>
        <div class="cart-items" id="cartItems">
            <div class="empty-cart">
                <p>è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>
                <p class="empty-cart-hint">å¿«å»æŒ‘é¸å–œæ­¡çš„å•†å“å§ï¼</p>
            </div>
        </div>
        <div class="cart-footer">
            <div class="shipping-method-selector">
                <label>é‹é€æ–¹å¼ï¼š</label>
                <div class="shipping-options">
                    <label class="shipping-option">
                        <input type="radio" name="shippingMethod" value="pickup"
                            onchange="Checkout.setShippingMethod('pickup')">
                        <span>é™å°ä¸­å¸‚é¢äº¤ <strong>å…é‹</strong></span>
                    </label>
                    <label class="shipping-option">
                        <input type="radio" name="shippingMethod" value="711" checked
                            onchange="Checkout.setShippingMethod('711')">
                        <span>7-11 åº—åˆ°åº— <strong>NT$ 60</strong></span>
                    </label>
                </div>
            </div>
            <div class="cart-total">
                <span>ç¸½è¨ˆï¼š</span>
                <span class="total-amount" id="totalAmount">NT$ 0</span>
            </div>
            <button class="checkout-btn" id="checkoutBtn">å‰å¾€çµå¸³</button>
        </div>
    </div>

    <!-- å•†å“è©³æƒ…æ¨¡æ…‹æ¡† -->
    <div class="modal" id="productModal">
        <div class="modal-content product-detail">
            <button class="modal-close" onclick="ProductDetail.close()">âœ•</button>
            <div class="product-detail-grid">
                <div class="product-detail-image">
                    <img id="modalProductImage" src="" alt="">
                </div>
                <div class="product-detail-info">
                    <h2 id="modalProductName"></h2>
                    <p class="product-detail-price" id="modalProductPrice"></p>
                    <div id="modalProductOptions" class="product-options-container"></div>
                    <div class="quantity-selector">
                        <label>æ•¸é‡ï¼š</label>
                        <div class="qty-group">
                            <button class="qty-btn" onclick="ProductDetail.decreaseQuantity()">-</button>
                            <input type="number" id="modalQuantity" value="1" min="1" readonly>
                            <button class="qty-btn" onclick="ProductDetail.increaseQuantity()">+</button>
                        </div>
                    </div>
                    <button class="add-to-cart-btn" onclick="ProductDetail.addToCart()">åŠ å…¥è³¼ç‰©è»Š</button>
                    <p class="product-detail-description" id="modalProductDescription"></p>
                    <div class="product-detail-stock">åº«å­˜ï¼š<span id="modalProductStock"></span> ä»¶</div>
                </div>
            </div>
        </div>
    </div>

    <!-- çµå¸³æ¨¡æ…‹æ¡† -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content checkout-form">
            <button class="modal-close" onclick="Modal.close('checkoutModal')">âœ•</button>
            <h2>å¡«å¯«æ”¶ä»¶è³‡è¨Š</h2>
            <form id="orderForm">
                <div class="form-group">
                    <label for="customerName">å§“å *</label>
                    <input type="text" id="customerName" name="name" required placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
                </div>
                <div class="form-group">
                    <label for="customerPhone">æ‰‹æ©Ÿè™Ÿç¢¼ *</label>
                    <input type="tel" id="customerPhone" name="phone" required placeholder="0912345678">
                </div>
                <div class="form-group">
                    <label for="customerLineId">Line ID *</label>
                    <input type="text" id="customerLineId" name="lineId" required placeholder="è«‹è¼¸å…¥ Line ID">
                </div>
                <div class="form-group">
                    <label for="customerEmail">é›»å­ä¿¡ç®± *</label>
                    <input type="email" id="customerEmail" name="email" required placeholder="example@email.com">
                </div>
                <div id="storeFieldsSection">
                    <div class="shipping-notice">
                        <p>ğŸ“¦ æ‚¨é¸æ“‡äº† <strong>7-11 åº—åˆ°åº—</strong> å–è²¨</p>
                    </div>
                    <div class="form-group">
                        <label for="storeName">7-11 é–€å¸‚åç¨± *</label>
                        <input type="text" id="storeName" name="storeName" required placeholder="ä¾‹å¦‚ï¼šä¿¡ç¾©é–€å¸‚">
                    </div>
                    <div class="form-group">
                        <label for="storeCode">é–€å¸‚åº—è™Ÿ *</label>
                        <input type="text" id="storeCode" name="storeCode" required placeholder="ä¾‹å¦‚ï¼š123456">
                    </div>
                    <div class="form-group">
                        <label for="storeAddress">é–€å¸‚åœ°å€ *</label>
                        <input type="text" id="storeAddress" name="storeAddress" required placeholder="å°åŒ—å¸‚ä¿¡ç¾©å€XXè·¯XXè™Ÿ">
                    </div>
                </div>
                <div class="form-group">
                    <label for="customerNote">å‚™æ³¨ï¼ˆé¸å¡«ï¼‰</label>
                    <textarea id="customerNote" name="note" rows="3"></textarea>
                </div>
                <div class="order-summary">
                    <h3>è¨‚å–®æ‘˜è¦</h3>
                    <div id="orderSummary"></div>
                    <div class="order-total">ç¸½é‡‘é¡ï¼š<span id="orderTotal">NT$ 0</span></div>
                </div>
                <button type="submit" class="submit-order-btn">ç¢ºèªé€å‡ºè¨‚å–®</button>
            </form>
        </div>
    </div>

    <!-- æˆåŠŸæç¤º -->
    <div class="modal" id="successModal">
        <div class="modal-content success-message">
            <div class="success-icon">âœ“</div>
            <h2>è¨‚å–®é€å‡ºæˆåŠŸï¼</h2>
            <p>æ‚¨çš„è¨‚å–®ç·¨è™Ÿï¼š<strong id="orderNumber"></strong></p>
            <button class="continue-btn" onclick="Modal.close('successModal')">ç¹¼çºŒè³¼ç‰©</button>
        </div>
    </div>

    <!-- é®ç½©å±¤ -->
    <div class="overlay" id="overlay"></div>

    <!-- è¨‚å–®æŸ¥è©¢ -->
    <div class="modal" id="searchOrderModal">
        <div class="modal-content search-order-form">
            <button class="modal-close" onclick="closeSearchModal()">âœ•</button>
            <h2>è¨‚å–®æŸ¥è©¢</h2>
            <div class="search-input-group">
                <p>è«‹è¼¸å…¥è¨‚è³¼æ™‚çš„æ‰‹æ©Ÿè™Ÿç¢¼æŸ¥è©¢è¨‚å–®ç‹€æ…‹</p>
                <div class="form-group">
                    <input type="tel" id="searchPhone" placeholder="ä¾‹å¦‚ï¼š0912345678">
                    <button class="submit-order-btn" onclick="handleOrderSearch()" style="margin-top: 10px;">æŸ¥è©¢</button>
                </div>
            </div>
            <div id="searchResults" class="search-results"></div>
        </div>
    </div>

    <!-- JavaScript æ¨¡çµ„è¼‰å…¥ -->
    <script src="/src/core/api.js"></script>
    <script src="/src/core/storage.js"></script>
    <script src="/src/core/toast.js"></script>
    <script src="/src/core/utils.js"></script>
    <script src="/src/store/modules/products.js"></script>
    <script src="/src/store/modules/cart.js"></script>
    <script src="/src/store/modules/modal.js"></script>
    <script src="/src/store/modules/product-detail.js"></script>
    <script src="/src/store/modules/checkout.js"></script>
    <script src="/src/store/modules/kol-store.js"></script>
    <script src="/src/page-renderer/page-renderer.js"></script>
    <script src="/src/store/app.js"></script>

    <script>
        // KOL å•†åº—åˆå§‹åŒ– - ä½¿ç”¨é è¼‰å…¥çš„è³‡æ–™
        window.STORE_CONFIG = {
            storeId: '{{STORE_ID}}',
            storeName: '{{STORE_NAME}}',
            themeColor: '{{THEME_COLOR}}',
            logoUrl: '{{STORE_LOGO}}'
        };
    </script>
</body>

</html>